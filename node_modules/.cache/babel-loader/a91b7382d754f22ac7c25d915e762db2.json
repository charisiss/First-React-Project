{"ast":null,"code":"'use strict';\n\nconst {\n  Buffer\n} = require('node:buffer');\n\nconst fs = require('node:fs');\n\nconst path = require('node:path');\n\nconst stream = require('node:stream');\n\nconst fetch = require('node-fetch');\n\nconst {\n  Error: DiscordError,\n  TypeError\n} = require('../errors');\n\nconst Invite = require('../structures/Invite');\n/**\n * The DataResolver identifies different objects and tries to resolve a specific piece of information from them.\n * @private\n */\n\n\nclass DataResolver extends null {\n  /**\n   * Data that can be resolved to give an invite code. This can be:\n   * * An invite code\n   * * An invite URL\n   * @typedef {string} InviteResolvable\n   */\n\n  /**\n   * Data that can be resolved to give a template code. This can be:\n   * * A template code\n   * * A template URL\n   * @typedef {string} GuildTemplateResolvable\n   */\n\n  /**\n   * Resolves the string to a code based on the passed regex.\n   * @param {string} data The string to resolve\n   * @param {RegExp} regex The RegExp used to extract the code\n   * @returns {string}\n   */\n  static resolveCode(data, regex) {\n    return data.matchAll(regex).next().value?.[1] ?? data;\n  }\n  /**\n   * Resolves InviteResolvable to an invite code.\n   * @param {InviteResolvable} data The invite resolvable to resolve\n   * @returns {string}\n   */\n\n\n  static resolveInviteCode(data) {\n    return this.resolveCode(data, Invite.INVITES_PATTERN);\n  }\n  /**\n   * Resolves GuildTemplateResolvable to a template code.\n   * @param {GuildTemplateResolvable} data The template resolvable to resolve\n   * @returns {string}\n   */\n\n\n  static resolveGuildTemplateCode(data) {\n    const GuildTemplate = require('../structures/GuildTemplate');\n\n    return this.resolveCode(data, GuildTemplate.GUILD_TEMPLATES_PATTERN);\n  }\n  /**\n   * Resolves a Base64Resolvable, a string, or a BufferResolvable to a Base 64 image.\n   * @param {BufferResolvable|Base64Resolvable} image The image to be resolved\n   * @returns {Promise<?string>}\n   */\n\n\n  static async resolveImage(image) {\n    if (!image) return null;\n\n    if (typeof image === 'string' && image.startsWith('data:')) {\n      return image;\n    }\n\n    const file = await this.resolveFileAsBuffer(image);\n    return DataResolver.resolveBase64(file);\n  }\n  /**\n   * Data that resolves to give a Base64 string, typically for image uploading. This can be:\n   * * A Buffer\n   * * A base64 string\n   * @typedef {Buffer|string} Base64Resolvable\n   */\n\n  /**\n   * Resolves a Base64Resolvable to a Base 64 image.\n   * @param {Base64Resolvable} data The base 64 resolvable you want to resolve\n   * @returns {?string}\n   */\n\n\n  static resolveBase64(data) {\n    if (Buffer.isBuffer(data)) return `data:image/jpg;base64,${data.toString('base64')}`;\n    return data;\n  }\n  /**\n   * Data that can be resolved to give a Buffer. This can be:\n   * * A Buffer\n   * * The path to a local file\n   * * A URL <warn>When provided a URL, discord.js will fetch the URL internally in order to create a Buffer.\n   * This can pose a security risk when the URL has not been sanitized</warn>\n   * @typedef {string|Buffer} BufferResolvable\n   */\n\n  /**\n   * @external Stream\n   * @see {@link https://nodejs.org/api/stream.html}\n   */\n\n  /**\n   * Resolves a BufferResolvable to a Buffer or a Stream.\n   * @param {BufferResolvable|Stream} resource The buffer or stream resolvable to resolve\n   * @returns {Promise<Buffer|Stream>}\n   */\n\n\n  static async resolveFile(resource) {\n    if (Buffer.isBuffer(resource) || resource instanceof stream.Readable) return resource;\n\n    if (typeof resource === 'string') {\n      if (/^https?:\\/\\//.test(resource)) {\n        const res = await fetch(resource);\n        return res.body;\n      }\n\n      return new Promise((resolve, reject) => {\n        const file = path.resolve(resource);\n        fs.stat(file, (err, stats) => {\n          if (err) return reject(err);\n          if (!stats.isFile()) return reject(new DiscordError('FILE_NOT_FOUND', file));\n          return resolve(fs.createReadStream(file));\n        });\n      });\n    }\n\n    throw new TypeError('REQ_RESOURCE_TYPE');\n  }\n  /**\n   * Resolves a BufferResolvable to a Buffer.\n   * @param {BufferResolvable|Stream} resource The buffer or stream resolvable to resolve\n   * @returns {Promise<Buffer>}\n   */\n\n\n  static async resolveFileAsBuffer(resource) {\n    const file = await this.resolveFile(resource);\n    if (Buffer.isBuffer(file)) return file;\n    const buffers = [];\n\n    for await (const data of file) buffers.push(data);\n\n    return Buffer.concat(buffers);\n  }\n\n}\n\nmodule.exports = DataResolver;","map":{"version":3,"names":["Buffer","require","fs","path","stream","fetch","Error","DiscordError","TypeError","Invite","DataResolver","resolveCode","data","regex","matchAll","next","value","resolveInviteCode","INVITES_PATTERN","resolveGuildTemplateCode","GuildTemplate","GUILD_TEMPLATES_PATTERN","resolveImage","image","startsWith","file","resolveFileAsBuffer","resolveBase64","isBuffer","toString","resolveFile","resource","Readable","test","res","body","Promise","resolve","reject","stat","err","stats","isFile","createReadStream","buffers","push","concat","module","exports"],"sources":["C:/Users/xsxsam/node_modules/discord.js/src/util/DataResolver.js"],"sourcesContent":["'use strict';\n\nconst { Buffer } = require('node:buffer');\nconst fs = require('node:fs');\nconst path = require('node:path');\nconst stream = require('node:stream');\nconst fetch = require('node-fetch');\nconst { Error: DiscordError, TypeError } = require('../errors');\nconst Invite = require('../structures/Invite');\n\n/**\n * The DataResolver identifies different objects and tries to resolve a specific piece of information from them.\n * @private\n */\nclass DataResolver extends null {\n  /**\n   * Data that can be resolved to give an invite code. This can be:\n   * * An invite code\n   * * An invite URL\n   * @typedef {string} InviteResolvable\n   */\n\n  /**\n   * Data that can be resolved to give a template code. This can be:\n   * * A template code\n   * * A template URL\n   * @typedef {string} GuildTemplateResolvable\n   */\n\n  /**\n   * Resolves the string to a code based on the passed regex.\n   * @param {string} data The string to resolve\n   * @param {RegExp} regex The RegExp used to extract the code\n   * @returns {string}\n   */\n  static resolveCode(data, regex) {\n    return data.matchAll(regex).next().value?.[1] ?? data;\n  }\n\n  /**\n   * Resolves InviteResolvable to an invite code.\n   * @param {InviteResolvable} data The invite resolvable to resolve\n   * @returns {string}\n   */\n  static resolveInviteCode(data) {\n    return this.resolveCode(data, Invite.INVITES_PATTERN);\n  }\n\n  /**\n   * Resolves GuildTemplateResolvable to a template code.\n   * @param {GuildTemplateResolvable} data The template resolvable to resolve\n   * @returns {string}\n   */\n  static resolveGuildTemplateCode(data) {\n    const GuildTemplate = require('../structures/GuildTemplate');\n    return this.resolveCode(data, GuildTemplate.GUILD_TEMPLATES_PATTERN);\n  }\n\n  /**\n   * Resolves a Base64Resolvable, a string, or a BufferResolvable to a Base 64 image.\n   * @param {BufferResolvable|Base64Resolvable} image The image to be resolved\n   * @returns {Promise<?string>}\n   */\n  static async resolveImage(image) {\n    if (!image) return null;\n    if (typeof image === 'string' && image.startsWith('data:')) {\n      return image;\n    }\n    const file = await this.resolveFileAsBuffer(image);\n    return DataResolver.resolveBase64(file);\n  }\n\n  /**\n   * Data that resolves to give a Base64 string, typically for image uploading. This can be:\n   * * A Buffer\n   * * A base64 string\n   * @typedef {Buffer|string} Base64Resolvable\n   */\n\n  /**\n   * Resolves a Base64Resolvable to a Base 64 image.\n   * @param {Base64Resolvable} data The base 64 resolvable you want to resolve\n   * @returns {?string}\n   */\n  static resolveBase64(data) {\n    if (Buffer.isBuffer(data)) return `data:image/jpg;base64,${data.toString('base64')}`;\n    return data;\n  }\n\n  /**\n   * Data that can be resolved to give a Buffer. This can be:\n   * * A Buffer\n   * * The path to a local file\n   * * A URL <warn>When provided a URL, discord.js will fetch the URL internally in order to create a Buffer.\n   * This can pose a security risk when the URL has not been sanitized</warn>\n   * @typedef {string|Buffer} BufferResolvable\n   */\n\n  /**\n   * @external Stream\n   * @see {@link https://nodejs.org/api/stream.html}\n   */\n\n  /**\n   * Resolves a BufferResolvable to a Buffer or a Stream.\n   * @param {BufferResolvable|Stream} resource The buffer or stream resolvable to resolve\n   * @returns {Promise<Buffer|Stream>}\n   */\n  static async resolveFile(resource) {\n    if (Buffer.isBuffer(resource) || resource instanceof stream.Readable) return resource;\n    if (typeof resource === 'string') {\n      if (/^https?:\\/\\//.test(resource)) {\n        const res = await fetch(resource);\n        return res.body;\n      }\n\n      return new Promise((resolve, reject) => {\n        const file = path.resolve(resource);\n        fs.stat(file, (err, stats) => {\n          if (err) return reject(err);\n          if (!stats.isFile()) return reject(new DiscordError('FILE_NOT_FOUND', file));\n          return resolve(fs.createReadStream(file));\n        });\n      });\n    }\n\n    throw new TypeError('REQ_RESOURCE_TYPE');\n  }\n\n  /**\n   * Resolves a BufferResolvable to a Buffer.\n   * @param {BufferResolvable|Stream} resource The buffer or stream resolvable to resolve\n   * @returns {Promise<Buffer>}\n   */\n  static async resolveFileAsBuffer(resource) {\n    const file = await this.resolveFile(resource);\n    if (Buffer.isBuffer(file)) return file;\n\n    const buffers = [];\n    for await (const data of file) buffers.push(data);\n    return Buffer.concat(buffers);\n  }\n}\n\nmodule.exports = DataResolver;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}